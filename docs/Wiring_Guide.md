# 智能水族箱硬件采购与接线指南

本文面向零基础学生，手把手说明如何购买硬件、准备工具、完成接线并检查供电安全。所有描述与仓库固件、文档保持一致，请务必按顺序操作。

## 1. 元器件清单（必买 / 可不买）

### 必买（最小功能闭环）

以下器件用于完成“设备上电 → 采集上报 → 云端下发 → 设备执行”的最小演示闭环。

| 购买状态 | 名称 | 数量 | 选择建议 | 备注 |
|------|------|------|----------|------|
| [x] | STM32 NUCLEO-F103RB 开发板 | 已买 x1 | 选购原装或 ST 授权板卡 | 带 USB 线；用于运行固件 |
| [x] | ESP32-WROOM 模块（AT 固件） | 已买 x1 | 带 3.3 V 供电与 UART 引脚 | 负责 Wi-Fi 与 MQTT |
| [x] | DS18B20 防水温度探头 | 已买 x1 | 带金属探头与三芯线 | 测量水温 |
| [x] | 4.7 kΩ 上拉电阻 | 已买 x1 组 | 1/4 W 金属膜电阻 | 已买：电阻包 x1（含 4.7 kΩ） |
| [x] | pH 传感器套件（含 BNC 探头+信号板） | 已买 x1 套 | 常见 BNC 头 + 信号板 | 已买：pH 模块 x1 + pH 电极 x1 |
| [x] | TDS（水质）传感器套件（含探头） | 已买 x1 套 | 选购 0–3.3 V 输出版本 | 测量总溶解固体 |
| [x] | 浊度传感器模块 | 已买 x1 | 建议买带透明探头、防水 | 输出 0–3.3 V |
| [x] | 水位传感器（电阻式或浮球+分压） | 已买 x1 | 采用连续式，输出 0–3.3 V | 需要与水面垂直放置 |
| [x] | 分压电阻（10 kΩ + 20 kΩ） | 已买 x1 组 | 1/4 W 金属膜电阻 | 已买：电阻包 x1（含 10 kΩ/20 kΩ） |
| [x] | 继电器模块（三路） | 已买 x1 | 优先高电平触发或可切换触发、5 V 驱动 | 控制进水泵、排水泵、加热棒 |
| [x] | 舵机（SG90 或金属齿轮） | 已买 x1 | 带安装支架 | 驱动投饵装置（可空转演示） |
| [x] | 蜂鸣器模块（有源） | 已买 x1 | 5 V 或 3.3 V 版本均可 | 告警提示 |
| [x] | LED 指示灯 + 电阻 | 已买 x1 组 | LED 1 个、限流电阻 330 Ω | 已买：LED x1 + 电阻包 x1 |
| [x] | OLED 屏（0.96 英寸 I2C） | 已买 x1 | 128×64 像素、3.3 V 供电 | 显示状态 |
| [x] | 12 V 小型进水泵 | 已买 x1 | 选购食品级材质 | 与排水泵同款，合计水泵 x2 |
| [x] | 12 V 小型排水泵 | 已买 x1 | 同上 | 与进水泵同款，合计水泵 x2 |
| [x] | 食品级硅胶水管（内径约 6 mm，外径约 10 mm） | 已买 x2 | 软管材质标注“食品级” | 2m/条，共 4m，连接进/排水泵 |
| [x] | 加热棒或加热器 | 已买 x1 | 功率根据鱼缸大小选择 | 与继电器串联 |
| [x] | 12 V 开关电源（≥3 A） | 已买 x1 | 给泵和板卡供电 | 需要 DC 插头 |
| [x] | DC 5.5x2.1 电源插头/母座接线端子 | 已买 x1 | 可选带螺丝端子款 | 便于 12 V 电源接线 |
| [x] | 降压模块（12 V → 5 V） | 已买 x1 | 输出至少 2 A | 供给继电器、舵机、STM32 |
| [x] | 面包板或转接板 + 杜邦线 | 已买 x1 套 | 公母线各 20 根以上 | 已买：面包板 x1 + 杜邦线 x1 |
| [x] | 水族箱/透明水箱（约 20–40 L） | 自备 x1 | 玻璃或亚克力材质 | 不需要购买，准备任意可容水容器即可 |
| [x] | 进水桶 + 排水桶（或储水箱） | 自备 x2 | 20–30 L | 建议两容器（净水/废水），如只做补水可自备 1 个 |
| [x] | 3.3 V 稳压模块（5 V → 3.3 V） | 已买 x1 | 输出 ≥ 500 mA | 给 ESP32 供电更稳，避免板载 3.3 V 负载不足 |

### 可不买（不影响最小闭环）

以下项目属于安装/展示增强件，本项目课程演示可先不买。

| 购买状态 | 名称 | 数量 | 作用 | 不买时替代方案 |
|------|------|------|------|------|
| [x] | 管箍/卡箍（8–12 mm） | 已买 x6 | 固定水管防漏 | 演示阶段可用扎带临时固定，注意缩短运行时长并观察漏水 |
| [x] | 传感器固定吸盘/夹具套件 | 已买 x1 | 固定温度/pH/TDS/浊度/水位探头 | 可用胶带或临时夹具固定 |
| [x] | 投饵装置套件（适配 SG90） | 已买 x1 套 | 将舵机动作转换为实际投饵 | 可先只演示舵机转动与云端控制 |
| [x] | 防水接线盒 | 已买 x1 | 保护板卡与继电器 | 室内短时演示可放在干燥高位，避免泼溅 |

### 必备工具

- 十字螺丝刀、剪线钳、剥线钳；
- 万用表（检查电压与连通性）；
- 扎带或粘扣带（整理线材）；
- 绝缘胶带或热缩管（防止短路）。

### 当前购物车采购链接（2026-02-20）

说明：
- 该清单来自当前淘宝购物车（共 24 条）。
- 硅胶软管按当前决策保留 1 份（2 米）。
- 12V 供电采用锂电池组（带充电器）方案。

| 序号 | 商品 | 规格 | 数量 | 链接 |
|---|---|---|---:|---|
| 1 | 彩色杜邦线40P 公对公/母对母/公对母10/20/30cm连接线面包板线 | 20cm公对公 | 1 | https://item.taobao.com/item.htm?id=693216069245 |
| 2 | 彩色杜邦线40P 公对公/母对母/公对母10/20/30cm连接线面包板线 | 20cm公对母 | 1 | https://item.taobao.com/item.htm?id=693216069245 |
| 3 | 彩色杜邦线40P 公对公/母对母/公对母10/20/30cm连接线面包板线 | 20cm母对母 | 1 | https://item.taobao.com/item.htm?id=693216069245 |
| 4 | 12V锂电池组大容量氙气灯diy智能小车太阳能路灯户外电源12伏电瓶 | 12V【2200mAh】DC公母[头配1A充电器] | 1 | https://item.taobao.com/item.htm?id=562015429673 |
| 5 | 直流5V12V24V36V48V 60V防水加热管电热棒 潜水加热管 机油加热棒 | 防水12V/6W | 1 | https://item.taobao.com/item.htm?id=524519364659 |
| 6 | pH不可充式电极探头 PH值测试 采集酸碱度传感器 监测模块ph0-14 | 单PH测试模块+不可充式电极探头(黑色） | 1 | https://item.taobao.com/item.htm?id=648937675220 |
| 7 | MB-102多路电压供电模块面包板实验套件diy电路板Type-C接口 | 【课设专用✅】MB-102电源板 | 1 | https://item.taobao.com/item.htm?id=994550991077 |
| 8 | TS-300B浊度模块水浑浊度污水水质检测模块浊度传感器模块 送程序 | 浊度传感器探头 | 1 | https://item.taobao.com/item.htm?id=682531973052 |
| 9 | NUCLEO-F103RB STM32F103RBT6 微控制器 STM32 Nucleo-64开发板 | NUCLEO-F103RB | 1 | https://item.taobao.com/item.htm?id=824002574639 |
| 10 | MicroPython ESP32开发板 V1.0.0 Rev1 wifi蓝牙4MB FLASH AT固件 | TYPE-C接口 | 1 | https://item.taobao.com/item.htm?id=639571021036 |
| 11 | DS18B20数字温度传感器探头 不锈钢封装防水型 水温探测温线 1米 | - | 1 | https://item.taobao.com/item.htm?id=558329645868 |
| 12 | 有源蜂鸣器模块高电平触发电压3.3 5V控制板传感器固定螺纹孔安装 | 蜂鸣器【多仓发货 大部分区域次日达】 | 1 | https://item.taobao.com/item.htm?id=685069687955 |
| 13 | 1/2/4/8路3V5V12V24V继电器模块一两四八路光耦隔离高低电平触发 | 3路5V汇科继电器 高电平3.3V-7V触发 | 1 | https://item.taobao.com/item.htm?id=608030089274 |
| 14 | 硅胶软管食品级耐高温透明高弹性硅橡胶抽水管内径12345 6 7 8 9 | 内径6mm×外径10mm（2米） | 1 | https://item.taobao.com/item.htm?id=612367961659 |
| 15 | 2.1*5.5mmDC接线端子插座 2.1mm母插12V低压电源头DC端子插头插座 | 2.1DC母插 | 1 | https://item.taobao.com/item.htm?id=558259675227 |
| 16 | TDS传感器模块/模拟信号水质检测源代码/探针stm32模块水质传感器 | TDS模块+TDS探针 | 1 | https://item.taobao.com/item.htm?id=644220334693 |
| 17 | DC-DC降压转换电源模块 4.8～40V转3/3.3v/3.7/5v/6/7.5/9/12V 1A | 3.3V输出 | 1 | https://item.taobao.com/item.htm?id=960198957083 |
| 18 | 原装正品 5MM/F5直插圆头LED灯珠红发红 红色发光二极管长脚 10只 | - | 1 | https://item.taobao.com/item.htm?id=544529384981 |
| 19 | OLED显示屏模块 0.96寸 IIC I2C接口 兼容UNO 液晶串口屏V | 白色 | 1 | https://item.taobao.com/item.htm?id=571173712417 |
| 20 | 3-5V水位传感器模块 电子雨滴液体水深识别检测感应开关控制器板 | 水位传感器模块 | 1 | https://item.taobao.com/item.htm?id=654013848048 |
| 21 | LM2596S DC直流可调降压板模块 带数显电压表显示12V 24V转5V 3A | 蓝板 LM2596S可调降压模块 | 1 | https://item.taobao.com/item.htm?id=662885799973 |
| 22 | 1/4W(0.25瓦) 10欧-1M金属膜电阻包 30种各20个共600个 五色环1% | 1/4W 10欧-1M金属膜电阻包 | 1 | https://item.taobao.com/item.htm?id=43943563249 |
| 23 | 385耐高温水泵100度小型微型抽冷却循环水泵水族隔膜泵DC12V长寿 | D12V【耐温100℃】385型 | 2 | https://item.taobao.com/item.htm?id=992978530388 |
| 24 | SG90 9G经典舵机 180/360度 数字舵机云台遥控飞机马达固定翼航 | 180度 | 1 | https://item.taobao.com/item.htm?id=895293322701 |

## 2. 接线总览

下表给出每个传感器/执行器与 NUCLEO 板的连接关系。STM32 引脚采用板卡丝印（例如 D2、A0），便于对应杜邦线。

| 功能模块 | 设备端引脚 | STM32 引脚 | 供电说明 |
|----------|------------|------------|----------|
| DS18B20 温度探头 | 黄色（数据） | D7 (PA8) | 红线接 3.3 V，黑线接 GND，数据线与 4.7 kΩ 上拉至 3.3 V |
| pH 传感器输出 | Vout | A0 (PA0) | VCC=5 V，GND 共地 |
| TDS 传感器输出 | Vout | A1 (PA1) | VCC=5 V，GND 共地 |
| 浊度传感器输出 | Vout | A2 (PA4) | VCC=5 V，GND 共地 |
| 水位传感器输出 | Vout | A3 (PB0) | 需分压至 0–3.3 V，GND 共地 |
| 进水泵继电器 IN1 | IN1 | D4 (PB5) | VCC=5 V，JD-VCC=5 V，GND 共地 |
| 排水泵继电器 IN2 | IN2 | D5 (PB4) | 同上 |
| 加热棒继电器 IN3 | IN3 | D6 (PB10) | 同上 |
| 蜂鸣器模块 | SIG | D8 (PA9) | VCC=5 V，GND 共地 |
| LED 指示灯 | 正极 | D13 (PA5) | 串联 330 Ω 电阻，负极接 GND |
| 舵机信号线 | 橙线 | D9 (PC7) | 红线接 5 V，黑线接 GND，建议使用独立 5 V 供电并与 STM32 共地 |
| OLED I2C | SCL、SDA | D15 (PB8)、D14 (PB9) | VCC 接 3.3 V，GND 共地 |
| ESP32 AT 模块 | TX、RX、EN、RST | D1 (PA2, TX)、D0 (PA3, RX)、3.3 V、PC2（可选复位） | 供电 3.3 V，若模块自带稳压，请确认默认电压 |
| ESP32 GND | GND | 与 STM32 共地 | 保证低阻连接 |

> **注意**：固件默认继电器 HIGH=ON；若你买到低电平触发模块，可通过跳帽切换触发电平，或在固件中反转输出。
> **注意**：IN2 使用 PB4（D5），固件已禁用 JTAG（保留 SWD）释放 PB4。

> **泵和加热棒接线**：继电器常开端接电源正极；设备电源线另一端接继电器 COM；设备电源负极直接接电源负极。操作者务必断电后再接线，并做好防水处理。

## 3. 详细接线步骤

1. **摆放器件**：将 NUCLEO 板与继电器模块固定在绝缘底板上，传感器与 ESP32 可使用双面胶固定。保持泵与电源之间有足够空间，避免水滴接触。
2. **供电准备**：将 12 V 电源通过降压模块输出稳定的 5 V，5 V 同时供给 STM32（VIN）、继电器、舵机及传感器。3.3 V 建议由独立稳压模块供给 ESP32；DS18B20、OLED 可由 STM32 3.3 V 提供（若 ESP32 模块自带稳压，可按卖家说明供电）。
3. **连接传感器线束**：按照表格将每一根信号线插到指定引脚，所有 GND 必须连在一起。建议先接地线，再接电源线，最后接信号线，避免误接导致短路。
4. **安装继电器与执行器**：将进水泵、排水泵、加热棒的正极串入继电器常开端，负极直接回到电源负极，并确认继电器供电线接好。务必检查泵的额定电压与电源匹配。
5. **舵机与投饵装置（投饵机构可选）**：舵机信号线接 D9，电源线连接 5 V 与 GND。若安装投饵机构，确保舵机可自由旋转 0–180°，无卡滞现象；不装机构时可直接做舵机动作演示。
6. **ESP32 模块**：使用 4 根杜邦线连接 TX→PA3(RX)、RX→PA2(TX)、VCC→3.3 V、GND→GND；如果需要硬件复位，可将 EN 脚拉高，将 RST 接到 STM32 PC2。若使用 ST-LINK VCP（PA2/PA3），请拔掉 VCP 跳帽避免冲突。
7. **OLED 显示屏**：将 SCL、SDA 接到 PB8、PB9，VCC 接 3.3 V，GND 接地。上电前确认没有松动。
8. **整理线缆**：使用扎带将不同功能的线束分组，尤其是高压电源线与信号线分开布置，防止互相干扰。

## 4. 上电前检查清单

在接通电源前，请逐项确认：

1. 所有 GND 已经互相连接（STM32、ESP32、传感器、继电器、舵机以及电源）；  
2. 传感器输出确保在 0–3.3 V 范围内（必要时使用电阻分压）；  
3. 继电器供电端（VCC、JD-VCC）已连接 5 V，且 COM/NO 接线正确；  
4. 舵机使用独立 5 V 供电时记得与 STM32 共地；  
5. ESP32 模块 UART 线没有接反（TX ↔ RX）；  
6. 泵与加热棒与外界水接触处做好绝缘，电源线没有裸露；  
7. OLED、温度探头等外设固定牢靠，避免运行时拉扯。

检查完成后，先接通 5 V 低压部分，确认 STM32 正常启动，再接通 12 V 供给泵和加热器。首次通电建议身边备有万用表，随时测量电压是否异常。

## 5. 常见问题与排查

- **OLED 无显示**：检查 VCC 是否接到 3.3 V，SCL/SDA 是否插反；必要时重新烧录固件。  
- **ESP32 无法联网**：确认模块供电为 3.3 V，天线无遮挡；使用串口监视器查看是否响应 AT 指令。  
- **泵不工作**：测试继电器指示灯是否亮；如继电器动作但泵不转，检查泵电压或是否有空气阻塞。  
- **传感器数值异常**：确保传感器探头完全浸入水中，信号线牢固；若仍异常，可通过移动端重新标定校准系数。  
- **舵机抖动**：可能是供电不足或信号线过长，可为舵机单独提供稳压电源，并在信号线上串接 220 Ω 电阻减小干扰。

## 6. 安全提示

1. 泵和加热棒涉及市电或大电流，请务必断电后操作；所有连接处使用防水胶带或热缩管保护。  
2. 不要在潮湿环境中使用裸露电源。推荐使用防水电源盒或将控制板固定在干燥位置。  
3. 若发现温度过高或泵长时间运行，请立即断电检查，防止器件损坏。  
4. 操作过程中若不小心接线错误导致发热或冒烟，应迅速断电并检查短路点。

按照本指南完成硬件搭建后，即可继续阅读 `README.md` 中的固件烧录与移动端部署说明，完成整个智能水族箱系统的组装与调试。
